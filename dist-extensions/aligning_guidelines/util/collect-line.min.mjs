import{Point as t}from"fabric";import{AligningLineConfig as n}from"../constant.min.mjs";import{getDistance as i,setPositionDir as e}from"./basic.min.mjs";function r(t){var i,e;const r=n.margin,{activeObject:s,activeObjectRect:a,objectRect:y}=t,d={target:s,list:c(y),aList:c(a),margin:r/(null!==(i=null===(e=s.canvas)||void 0===e?void 0:e.getZoom())&&void 0!==i?i:1)},h=function(t){const{target:n,list:i,aList:e,margin:r}=t,c=e.map((t=>o(t,i,"x"))),s=Math.min(...c.map((t=>t.dis)));if(s>r)return[];const a=[],y=e[0].x2-e[0].x,d=e[0].y2-e[0].y;let h=!1;for(let t=0;t<c.length;t++){const r=c[t];if(s==r.dis){const o=i[r.index],c=e[r.index],m=o.x,f=c.y,u=Math.min(o.y,o.y2,f,c.y2),g=Math.max(o.y,o.y2,f,c.y2);if(a.push({x:m,y1:u,y2:g}),h)continue;h=!0,x({target:n,x:m,y:f,centerX:t-1,centerY:r.index-1,width:y,height:d,dir:"x"});const l=s*r.dir;e.forEach((t=>t.x-=l))}}return a}(d),m=function(t){const{target:n,list:i,aList:e,margin:r}=t,c=e.map((t=>o(t,i,"y"))),s=Math.min(...c.map((t=>t.dis)));if(s>r)return[];const a=[],y=e[0].x2-e[0].x,d=e[0].y2-e[0].y;let h=!1;for(let t=0;t<c.length;t++){const r=c[t];if(s==r.dis){const o=i[r.index],c=e[r.index],m=o.y,f=c.x,u=Math.min(o.x,o.x2,f,c.x2),g=Math.max(o.x,o.x2,f,c.x2);if(a.push({y:m,x1:u,x2:g}),h)continue;h=!0,x({target:n,x:f,y:m,centerX:r.index-1,centerY:t-1,width:y,height:d,dir:"y"});const l=s*r.dir;e.forEach((t=>t.y-=l))}}return a}(d);return{vLines:h,hLines:m}}function o(t,n,e){let r=1/0,o=-1,c=1;for(let x=0;x<n.length;x++){const s=i(t[e],n[x][e]);r>s&&(o=x,r=s,c=t[e]>n[x][e]?1:-1)}return{dis:r,index:o,dir:c}}function c(t){const{left:n,top:i,width:e,height:r}=t,o=n+e/2,c=i+r/2;return[{x:n,y:i,x2:n+e,y2:i+r},{x:o,y:c,x2:o,y2:c},{x:n+e,x2:n,y:i+r,y2:i}]}function x(n){const{target:i,centerX:r,centerY:o,width:c,height:x,dir:s}=n;let{x:a,y:y}=n;a-=r*c/2,y-=o*x/2,e(i,new t(a,y),s),i.setCoords()}export{r as collectLine};
//# sourceMappingURL=collect-line.min.mjs.map
